<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Accessibility Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.4;
            font-size: 14px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.8rem;
        }
        
        .header p {
            color: #666;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .toggle-switch {
            margin: 0 10px;
            padding: 6px 12px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        .toggle-switch:hover {
            background: #f5f5f5;
        }
        
        .palette {
            background: white;
            border-radius: 8px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        
        .palette-title {
            color: #2c3e50;
            padding: 15px 20px;
            font-weight: bold;
            font-size: 1rem;
            min-width: 180px;
            writing-mode: horizontal-tb;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #eee;
        }
        
        .palette-content {
            flex: 1;
            padding: 12px;
        }
        
        .colors-container {
            display: flex;
            align-items: flex-start;
            gap: 30px;
        }
        
        .color-group {
            display: flex;
            flex-direction: column;
        }
        
        .group-title {
            font-size: 0.7rem;
            color: #999;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }
        
        .color-grid {
            display: flex;
            gap: 8px;
        }
        
        .color-swatch {
            width: 150px;
            height: 65px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.7rem;
            border-radius: 6px;
            border: 1px solid rgba(0,0,0,0.1);
            position: relative;
            text-align: center;
            line-height: 1.2;
        }
        
        .swatch-text {
            margin-bottom: 4px;
        }
        
        .swatch-hex {
            font-family: 'Courier New', monospace;
            font-size: 0.65rem;
            opacity: 0.9;
        }
        
        .color-swatch.white-text {
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }
        
        .color-swatch.black-text {
            color: black;
            text-shadow: 1px 1px 1px rgba(255,255,255,0.7);
        }
        
        .auto-indicator {
            position: absolute;
            top: 2px;
            right: 2px;
            background: rgba(227, 242, 253, 0.9);
            color: #1565c0;
            font-size: 0.6rem;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
        }
        
        .issue-indicator {
            position: absolute;
            bottom: 2px;
            left: 2px;
            right: 2px;
            background: rgba(248, 215, 218, 0.95);
            color: #721c24;
            font-size: 0.6rem;
            padding: 2px 4px;
            border-radius: 2px;
            font-weight: bold;
        }
        
        .contrast-ratio {
            font-family: 'Courier New', monospace;
            font-size: 0.6rem;
            opacity: 0.8;
            margin-top: 2px;
        }
        
        .contrast-hidden .contrast-ratio {
            display: none;
        }
        
        .legend {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .legend h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        .legend-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            font-size: 0.85rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        @media (max-width: 768px) {
            .palette-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .palette-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Color Accessibility Tracker</h1>
            <p>Quick overview of palette accessibility - issues shown only when they exist</p>
        </div>
        
        <div class="controls">
            <button onclick="toggleDemo()" id="demoToggle" class="toggle-switch">Show Demo</button>
            <button onclick="toggleContrast()" id="contrastToggle" class="toggle-switch">Show Contrast Ratios</button>
        </div>
        
        <div class="legend">
            <h3>How to Read</h3>
            <div class="legend-content">
                <div class="legend-item">
                    <span><strong>Clean swatches:</strong> All accessibility tests pass</span>
                </div>
                <div class="legend-item">
                    <span><strong>Red alerts:</strong> Specific issues that need fixing</span>
                </div>
                <div class="legend-item">
                    <span><strong>AUTO:</strong> Best text color automatically selected for accents</span>
                </div>
            </div>
            
            <div id="demoSection" style="display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px; border-left: 4px solid #3498db;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                    <div>
                        <h4 style="margin-bottom: 8px; color: #2c3e50; font-size: 0.95rem;">Color Order & Text Rules:</h4>
                        <div style="font-size: 0.8rem; line-height: 1.4;">
                            <div><strong>1st & 2nd:</strong> Main colors (always white text)</div>
                            <div><strong>3rd:</strong> Light main (always black text)</div>
                            <div><strong>4th & 5th:</strong> Accents (auto-select best contrast)</div>
                        </div>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 8px; color: #2c3e50; font-size: 0.95rem;">WCAG AA Standards:</h4>
                        <div style="font-size: 0.8rem; line-height: 1.4;">
                            <div><strong>Normal text:</strong> 4.5:1 contrast minimum</div>
                            <div><strong>Large text:</strong> 3:1 contrast minimum</div>
                            <div><strong>Icons:</strong> Same as normal text (4.5:1)</div>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 style="margin-bottom: 8px; color: #2c3e50; font-size: 0.95rem;">How Text Color is Decided:</h4>
                    <div style="font-size: 0.8rem; line-height: 1.4;">
                        <strong>Auto-selection:</strong> For accent colors, we calculate contrast ratios against both white and black text, then automatically choose whichever gives better readability. This ensures maximum accessibility while giving you design flexibility with bright colors like yellows, oranges, and light blues that need black text, or dark colors that need white text.
                    </div>
                </div>
            </div>
        </div>
        
        <div class="palette contrast-hidden">
            <div class="palette-title">Emerald Blend</div>
            <div class="palette-content">
                <div class="colors-container">
                    <div class="color-group">
                        <div class="group-title">Main Colors</div>
                        <div class="color-grid">
                        <div class="color-item">
                            <div class="color-swatch white-text" style="background-color: #08494b;">
                                White Text
                                <div class="contrast-ratio">8.4:1</div>
                            </div>
                            <div class="swatch-hex">#08494b</div>
                        </div>
                        
                        <div class="color-item">
                            <div class="color-swatch white-text" style="background-color: #006956;">
                                White Text
                                <div class="contrast-ratio">6.8:1</div>
                            </div>
                            <div class="swatch-hex">#006956</div>
                        </div>
                        
                        <div class="color-item">
                            <div class="color-swatch black-text" style="background-color: #7ab2a7;">
                                Black Text
                                <div class="contrast-ratio">5.1:1</div>
                            </div>
                            <div class="swatch-hex">#7ab2a7</div>
                        </div>
                        </div>
                    </div>
                    
                    <div class="color-group">
                        <div class="group-title">Accent Colors</div>
                        <div class="color-grid">
                        <div class="color-item">
                            <div class="color-swatch white-text" style="background-color: #4b5dff;">
                                White Text
                                <div class="contrast-ratio">5.1:1</div>
                            </div>
                            <div class="swatch-hex">#4b5dff</div>
                        </div>
                        
                        <div class="color-item">
                            <div class="color-swatch white-text" style="background-color: #2f1f70;">
                                White Text
                                <div class="contrast-ratio">10.2:1</div>
                            </div>
                            <div class="swatch-hex">#2f1f70</div>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Contrast calculation functions
        function getContrastRatio(color1, color2) {
            const l1 = getLuminance(color1);
            const l2 = getLuminance(color2);
            const lighter = Math.max(l1, l2);
            const darker = Math.min(l1, l2);
            return (lighter + 0.05) / (darker + 0.05);
        }
        
        function getLuminance(hex) {
            const rgb = hexToRgb(hex);
            const [r, g, b] = rgb.map(c => {
                c = c / 255;
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            });
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        }
        
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? [
                parseInt(result[1], 16),
                parseInt(result[2], 16),
                parseInt(result[3], 16)
            ] : null;
        }
        
        function passesWCAG_AA(ratio, isLargeText = false) {
            return isLargeText ? ratio >= 3.0 : ratio >= 4.5;
        }
        
        function getBestTextColor(backgroundColor) {
            const whiteRatio = getContrastRatio(backgroundColor, '#ffffff');
            const blackRatio = getContrastRatio(backgroundColor, '#000000');
            return whiteRatio > blackRatio ? '#ffffff' : '#000000';
        }
        
        function addPalette(paletteName, colors) {
            const container = document.querySelector('.container');
            
            let mainColorsHTML = '';
            let accentColorsHTML = '';
            let hasIssues = false;
            
            colors.forEach((color, index) => {
                let textColor, textLabel, isAuto = false;
                
                if (index === 0 || index === 1) {
                    textColor = '#ffffff';
                    textLabel = 'White Text';
                } else if (index === 2) {
                    textColor = '#000000';
                    textLabel = 'Black Text';
                } else {
                    textColor = getBestTextColor(color);
                    textLabel = textColor === '#ffffff' ? 'White Text' : 'Black Text';
                    isAuto = true;
                }
                
                const ratio = getContrastRatio(color, textColor);
                const normalPass = passesWCAG_AA(ratio);
                const largePass = passesWCAG_AA(ratio, true);
                const iconPass = passesWCAG_AA(ratio);
                
                const previewClass = textColor === '#ffffff' ? 'white-text' : 'black-text';
                
                let accessibilityIssues = [];
                if (!normalPass) accessibilityIssues.push('Normal fails');
                if (!largePass) accessibilityIssues.push('Large fails');
                if (!iconPass) accessibilityIssues.push('Icons fail');
                
                let issueDisplay = '';
                let swatchClass = `color-swatch ${previewClass}`;
                
                if (accessibilityIssues.length > 0) {
                    hasIssues = true;
                    swatchClass += ' has-issues';
                    issueDisplay = '<div class="issue-indicator">FAIL</div>';
                }
                
                const swatchHTML = `
                    <div class="color-item">
                        <div class="${swatchClass}" style="background-color: ${color};">
                            ${textLabel}
                            <div class="contrast-ratio">${ratio.toFixed(1)}:1</div>
                            ${issueDisplay}
                        </div>
                        <div class="swatch-hex">${color}</div>
                    </div>
                `;
                
                if (index <= 2) {
                    mainColorsHTML += swatchHTML;
                } else {
                    accentColorsHTML += swatchHTML;
                }
            });
            
            const statusClass = hasIssues ? 'status-fail' : 'status-pass';
            const statusIcon = hasIssues ? '✗' : '✓';
            const statusText = hasIssues ? 'Has issues' : 'All tests pass';
            
            const paletteHTML = `
                <div class="palette contrast-hidden">
                    <div class="palette-title">
                        <div class="palette-name">${paletteName}</div>
                        <div class="palette-status ${statusClass}">
                            <span class="status-icon">${statusIcon}</span> ${statusText}
                        </div>
                    </div>
                    <div class="palette-content">
                        <div class="colors-container">
                            <div class="color-group">
                                <div class="group-title">Main Colors</div>
                                <div class="color-grid">
                                    ${mainColorsHTML}
                                </div>
                            </div>
                            
                            <div class="color-group">
                                <div class="group-title">Accent Colors</div>
                                <div class="color-grid">
                                    ${accentColorsHTML}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', paletteHTML);
        }
        
        function toggleDemo() {
            const demoSection = document.getElementById('demoSection');
            const toggleButton = document.getElementById('demoToggle');
            
            if (demoSection.style.display === 'none') {
                demoSection.style.display = 'block';
                toggleButton.textContent = 'Hide Demo';
            } else {
                demoSection.style.display = 'none';
                toggleButton.textContent = 'Show Demo';
            }
        }
        
        function toggleContrast() {
            const palettes = document.querySelectorAll('.palette');
            const toggleButton = document.getElementById('contrastToggle');
            const isCurrentlyHidden = palettes[0].classList.contains('contrast-hidden');
            
            palettes.forEach(palette => {
                if (isCurrentlyHidden) {
                    palette.classList.remove('contrast-hidden');
                } else {
                    palette.classList.add('contrast-hidden');
                }
            });
            
            toggleButton.textContent = isCurrentlyHidden ? 'Hide Contrast Ratios' : 'Show Contrast Ratios';
        }
        
        // Add all palettes with individual error handling
        const palettesToAdd = [
            ['Desert Sunrise', ['#3e2723', '#8d6e63', '#d7ccc8', '#ffd54f', '#bf9000']],
            ['Mountain Trail', ['#406446', '#5a8550', '#79a64c', '#4c79a6', '#003973']],
            ['Garden Party', ['#4a1b2f', '#a14a61', '#e9a6a7', '#b555ff', '#5b3c77']],
            ['Meadow Bloom', ['#24331c', '#6b7c2b', '#c3d989', '#3ab4ff', '#2d4a75']],
            ['Industrial Honey', ['#131613', '#4a4e4d', '#b5b8b7', '#ff9c00', '#b54b00']],
            ['Deep Space', ['#0c0f12', '#1d274f', '#3b9eff', '#00b894', '#00f0d1']],
            ['Quiet Morning', ['#6b5f57', '#a89d91', '#e2dbd3', '#a3b1b8', '#b6b5a0']],
            ['Neon Dreams', ['#3f3f3f', '#6a6a6a', '#b1b1b1', '#ff2ecd', '#c833ff']],
            ['Greenhouse Glow', ['#2d4a3a', '#4a6b5a', '#a8c4a2', '#ff6b6b', '#c44536']],
            ['Campfire Stories', ['#1e3a2e', '#3d5a4f', '#b8d4c2', '#ffb347', '#d2691e']],
            ['Vintage Elegance', ['#2c3e50', '#5d7a8a', '#c5d3d9', '#e8b4b8', '#a0556b']],
            ['Harbor Lights', ['#1a2332', '#3d4f5c', '#b8c5d1', '#ff8c42', '#cc5500']],
            ['Cyber Punk', ['#0f1419', '#2a3441', '#e8eaed', '#39ff14', '#00d4ff']],
            ['City Nights', ['#1c1c1e', '#48484a', '#f2f2f7', '#ff2d92', '#8e44ad']],
            ['Rocket Fuel', ['#0d1117', '#21262d', '#f0f6fc', '#ff6b35', '#1abc9c']],
            ['Electric Sunshine', ['#161618', '#2d2d30', '#f5f5f7', '#ffeb3b', '#2196f3']],
            ['Cloud Nine', ['#8a8a8a', '#b8b8b8', '#f0f0f0', '#d4d4d4', '#9e9e9e']],
            ['Spring Whisper', ['#c8d5c8', '#e1ebe1', '#f5f8f5', '#f0e6e6', '#e8e1f0']],
            ['Vanilla Bean', ['#707070', '#d4d0cc', '#f9f7f4', '#f5f2ee', '#e8e4e0']],
            ['Morning Mist', ['#c5d1d8', '#e8f0f5', '#f8fafb', '#faf9f7', '#e9e7e4']]
        ];
        
        palettesToAdd.forEach(([name, colors], index) => {
            try {
                addPalette(name, colors);
                console.log(`Successfully added palette ${index + 1}: ${name}`);
            } catch (error) {
                console.error(`Error adding palette ${name}:`, error);
            }
        });
        
        console.log('Color Accessibility Tracker loaded successfully!');
    </script>
</body>
</html>